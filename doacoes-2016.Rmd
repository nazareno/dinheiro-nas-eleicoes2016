---
title: "O dinheiro das campanhas para prefeito"
author: "Nazareno Andrade"
date: "24 de setembro de 2016"
output: 
  html_document:
    theme: readable
    fig_width: 7
    toc: true
    toc_float: true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(screenshot.force = FALSE, echo = FALSE, warning = FALSE) 
library(DT)
library(plotly)
source("doacoes.R")
theme_set(theme_bw())

#receitas = le_receitas("dados/receitas_candidatos_parcial_2016_brasil.txt")
#receitas %>% filter(Cargo == "Prefeito") %>%  write_csv("dados/receitas_prefeitaveis_parcial_2016.csv")

receitas = readr::read_csv("dados/receitas_prefeitaveis_parcial_2016.csv")

receitas_daqui = receitas %>% 
    filter(`Nome da UE` %in% c("CAMPINA GRANDE", 
                               "RIO DE JANEIRO", 
                               "JOÃO PESSOA", 
                               "SÃO PAULO"), 
           Cargo == "Prefeito") 

receitas_daqui$`Tipo receita` = factor(receitas_daqui$`Tipo receita`, 
                                          levels = c("Recursos de partido político", 
                                                     "Recursos de pessoas físicas", 
                                                     "Recursos próprios", 
                                                     "Recursos de outros candidatos", 
                                                     "Doações pela Internet", 
                                                     "Recursos de origens não identificadas"), 
                                          ordered = TRUE)

```

<br> 

## De onde vem?

Esse é o primeiro ano em que doações de empresas estão proibidas nas campanhas eleitorais. Isso criou a necessidade de muitos candidatos reinventarem a arrecadação de suas campanhas. De onde está vindo o dinheiro? 

Algumas campanhas -- a exemplo da de Marcelo Freixo no RJ -- estão apostando nas doações de pessoa física pela Internet. Todas podem ainda receber repasses dos partidos, que por sua vez recebem dinheiro do governo através do fundo partidário. Ou mesmo recursos da fortuna do próprio candidato. 

**Que candidaturas são construídas sobre que tipo de dinheiro?**

<br>

## em Campina Grande - PB 

Começando na cidade em que moro, resolvi ver nos dados que o TSE disponibiliza qual a origem do arrecadado por cada candidato a prefeito. Até 24-09-2016, eis a origem da verba de cada candidato: 

```{r, echo = FALSE, warning=FALSE}
r = receitas_daqui %>% 
    filter(`Nome da UE` == "CAMPINA GRANDE") %>% 
    rowwise() %>% 
    mutate(`Nome candidato` = switch (`Nome candidato`,
                                      "ADRIANO CEZAR GALDINO DE ARAÚJO" = "Adriano Galdino", 
                                      "JOSÉ ARTUR MELO DE ALMEIDA" = "Artur Bolinha", 
                                      "ROMERO RODRIGUES VEIGA" = "Romero", 
                                      "VENEZIANO VITAL DO REGO SEGUNDO NETO" = "Veneziano", 
                                      `Nome candidato`))

r %>% 
    plota_cidade_dimple("CAMPINA GRANDE", desloca_x = 100) 

#receitas %>% filter(`Nome da UE` == "JOÃO PESSOA", `Tipo receita` == "Recursos próprios") %>% select(-11:-1) %>% group_by(`Nome candidato`, `Nome do doador`, `Fonte recurso`) %>% summarise(x = sum(`Valor receita`)) %>% View()
```

Uma primeira coisa que salta aos olhos é que **Veneziano declarou ter arrecadado o dobro do segundo candidato que mais arrecadou**. 

Além disso, essa diferença acontece principalmente porque *Veneziano doou mais de R$ 400 mil à própria campanha*. Uma das maiores doações inclusive é **um depósito de R$ 169 mil em espécie**. Essa é uma doação bem notável: é a maior auto-doação na PB, é mais que o dobro da segunda na PB, só há uma doação de recursos próprios maior que essa em todas as campanhas de Pernambuco, e há apenas uma doação em espécie maior que essa no Nordeste -- em Caxias, no Maranhão.

Voltando o foco a Campina Grande, constatamos que **aqui todos os candidatos investem muito dinheiro próprio na eleição**.  Eis os dez maiores doadores com recursos próprios da Paraíba, e repare que quatro dos cinco maiores são em Campina Grande: 

```{r}
receitas %>% 
    filter(`Tipo receita` == "Recursos próprios", UF == "PB") %>% 
    rename("Cidade" = `Nome da UE`) %>% 
    group_by(`Nome do doador`, `Nome candidato`, Cidade) %>% 
    summarise(Doado = sum(`Valor receita`)) %>% 
    arrange(-Doado) %>% 
    ungroup() %>% 
    slice(1:10) %>%
    datatable(options = list(paging = F, info = F, search = F), rownames = FALSE)
```

<br> 

Olhando de onde a maior parte da verba de cada candidato veio, percebemos que a candidatura de Romero tem a maior parte de sua verba vinda diretamenteo do PSDB. Veneziano também recebeu um grande repasse do PMDB, enquanto Adriano e Bolinha não declararam ter recebido verba de seus partidos: 

```{r}
r %>% 
    plota_cidade_dimple("CAMPINA GRANDE", desloca_x = 100) %>% 
    rcdimple::xAxis(type = "addPctAxis")
```

Em contrapartida, Adriano e Bolinha são os candidatos cujas campanhas aparentemente estão mais financiadas por pessoas físicas. Curiosamente, contudo, apenas 3 pessoas realmente doaram verba para Adriano, e 4 para Artur Bolinha. O restante do recurso arrecadado foi todo na forma de serviços e bens cedidos para a campanha.

## em João Pessoa - PB

Em João Pessoa, apenas três candidatos já relataram sua arrecadação para o TSE, e a lógica do financiamento funciona bem diferente de Campina Grande. 

```{r, echo = FALSE}
r = receitas_daqui %>% 
    filter(`Nome da UE` == "JOÃO PESSOA") %>% 
    rowwise() %>% 
    mutate(`Nome candidato` = switch (`Nome candidato`,
                                      "LUCIANO CARTAXO PIRES DE SÁ" = "Luciano Cartaxo", 
                                      "CHARLITON JOSE DOS SANTOS MACHADO" = "Prof Charliton", 
                                      "MARIA APARECIDA RAMOS DE MENESES" = "Cida Ramos", 
                                      `Nome candidato`))

r %>% 
    plota_cidade_dimple("JOÃO PESSOA")
```

Primeiro, apenas um dos candidatos declarou ter usado recursos próprios: Luciano Cartaxo. E mesmo assim, ele doou apenas R$ 20 mil em verba. *Quatro vezes menos do que quem menos doou a si próprio em Campina Grande*.

Para dois dos candidatos, os partidos são também responsáveis pela maior parte da verba nas campanhas. Diferente de Campina Grande, o PSB é responsável por uma enorme parte da receita de Cida Ramos, e o PT por toda a verba declarada por Prof. Charliton. 

Luciano Cartaxo, por sua vez, tem a maior parte de seu apoio financeiro em pessoas físicas, e Cida também recebeu bastante de pessoas físicas. 

Como pessoas físicas podem doar em dinheiro ou serviços, separamos os dois e olhamos apenas apoios em dinheiro. Abaixo, cada ponto é o que uma pessoa física doou em dinheiro para a campanha de um dos candidatos de João Pessoa. Clique nos pontos para ver os detalhes.

```{r fig.width=6, fig.height=4}
pfs = r %>% 
    filter(`Nome da UE` == "JOÃO PESSOA", 
           `Tipo receita` == "Recursos de pessoas físicas", 
           `Especie recurso` != "Estimado") %>% 
    select(-11:-1) %>% 
    group_by(`Nome candidato`, `Nome do doador`, `Especie recurso`) %>% 
    summarise(Recebido = sum(`Valor receita`)) 

pfs_e = r %>% 
    ungroup() %>% 
    filter(`Nome da UE` == "JOÃO PESSOA", 
           `Tipo receita` == "Recursos de pessoas físicas", 
           `Especie recurso` == "Estimado") %>% 
    select(-11:-1) %>% 
    group_by(`Nome candidato`, `Nome do doador`, `Especie recurso`) %>% 
    distinct() %>% 
    ungroup() %>% 
    dplyr::count(`Nome candidato`)

p = pfs %>% 
    ungroup() %>% 
    rename(Doador = `Nome do doador`) %>% 
    ggplot(aes(x = `Nome candidato`, 
               y = Recebido, colour = `Nome candidato`, 
               label = Doador)) + 
    geom_point(position = position_jitter(width = .2), alpha = 0.5, size = 2.5) + 
    labs(x = "", y = "Doação", title = "Doações de verba de pessoa física") + 
    theme(legend.position = "none")

ggplotly(p, tooltip = c("y", "label"))
```

<br> 

O número de doações recebidas dos dois candidatos não é muito diferente. Mas há uma diferença perceptível nos valores. **Luciano Cartaxo tem vários doadores que contribuíram entre R$10 mil e R$15 mil para a sua campanha**, enquanto a campanha de Cida é feita de doações menores. A doação média das pessoas físicas na campanha de Cartaxo é hoje R$6.500,00; na de Cida, pouco menos de R$2.000,00.

```{r pfs_br}
pfsbr = receitas %>% 
    filter(`Tipo receita` == "Recursos de pessoas físicas", 
           `Especie recurso` != "Estimado", UF == "PB") %>% 
    group_by(`Nome da UE`, `Nome candidato`, `Nome do doador`) %>% 
    summarise(Recebido = sum(`Valor receita`)) %>% 
    summarise(Medio = mean(Recebido), 
              n = n()) %>% 
    arrange(-Medio)
```


## no Rio de Janeiro

Uma das modalidades de arrecadação este ano é com doações via internet. Nessa modalidade, o eleitor doa diretamente para seu candidato, de casa. O Rio de Janeiro é a única cidade onde esta forma de participação do eleitor parece ter dado certo. E apenas na campanha de Marcelo Freixo; 

```{r}
receitas %>% 
    filter(`Tipo receita` == "Doações pela Internet") %>% 
    group_by(`Nome candidato`, UF) %>% 
    summarise(n = n(), `Total (R$)` = sum(`Valor receita`)) %>% 
    ungroup() %>% 
    arrange(-n) %>% 
    slice(1:10) %>% 
    rename("Doações recebidas via Internet" = n) %>% 
    datatable(options = list(paging = F, info = F, search = F), rownames = FALSE)
```

<br> 

A composição da receita de campanha dos demais candidatos é novamente bastante diferente de Campina Grande. Tem algumas semelhanças com João Pessoa. De maneira geral os candidatos não investem tanto em suas campanhas, e dependem de partidos. O líder nas pesquisas, Crivella, praticamente não recebeu verbas de pessoas físicas. A campanha de Marcelo Freixo é composta em quase metade de verbas de pessoas físicas, principalmente pela Internet.

```{r, echo = FALSE}
receitas %>% 
    plota_cidade_dimple("RIO DE JANEIRO", desloca_x = 200)
```

